dir = "/Users/asingh/Dropbox/dfv/keendata/handlebar/appended/acxiom"
file_name = "keen_customer_data_appended.txt"

file_path = dir + "/" + file_name

spec= [ ["Name",70,1,70],
["ZipCode Option 1",10,71,80],
["ZipCode Option 2",10,81,90],
["ZipCode Option 3",10,91,100],
["City",20,101,120],
["DataSource",20,121,140],
["MATCH LEVEL INDICATOR",1,141,141],
["HOUSENUMBER",10,142,151],
["STREETDIRECTION",2,152,153],
["STREETNAME",20,154,173],
["SECONDARYADDRESS",25,174,198],
["CITYNAME",20,199,218],
["STATECODE",2,219,220],
["ZIPCODE",5,221,225],
["ZIP4CODE",4,226,229],
["IB TELESOURCE AREA CODE                              ",3,230,232],
["IB TELESOURCE PHONE NUMBER                           ",7,233,239],
["IB TELESOURCE TIME ZONE CODE                         ",1,240,240],
["IB TELESOURCE PHONE SOLICITATION FLAG",1,241,241],
["DMA NO-MAIL SOLICITATION FLAG",1,242,242],
["FINAL_EMAIL",50,243,292],
["Number of Sources",2,293,294],
["Adult Age Ranges Present in Household",21,295,315],
["Males 18-24",1,295,295],
["Females 18-24",1,296,296],
["Unknown Gender 18-24",1,297,297],
["Males 25-34",1,298,298],
["Females 25-34",1,299,299],
["Unknown Gender 25-34",1,300,300],
["Males 35-44",1,301,301],
["Females 35-44",1,302,302],
["Unknown Gender 35-44",1,303,303],
["Males 45-54",1,304,304],
["Females 45-54",1,305,305],
["Unknown Gender 45-54",1,306,306],
["Males 55-64",1,307,307],
["Females 55-64",1,308,308],
["Unknown Gender 55-64",1,309,309],
["Males 65-74",1,310,310],
["Females 65-74",1,311,311],
["Unknown Gender 65-74",1,312,312],
["Males 75+",1,313,313],
["Females 75+",1,314,314],
["Unknown Gender 75+",1,315,315],
["Age in Two-Year Increments - 1st Individual",2,316,317],
["Date of Birth - Input Individual (YYYY/MM)",8,318,325],
["Year",4,318,321],
["Month",2,322,323],
["Day",2,324,325],
["Age in Two-Year Increments - Input Individual",2,326,327],
["Investing - Active",1,328,328],
["Young Men's Apparel",1,329,329],
["Young Women's Apparel",1,330,330],
["Apparel - Women's - C",1,331,331],
["Automotive, Auto Parts and Accessories - SC",1,332,332],
["Jewelry - SC",1,333,333],
["Apparel - Men's - Big and Tall - C",1,334,334],
["Apparel - Children's - C",1,335,335],
["Apparel - Men's - C",1,336,336],
["Apparel - Women's - Petite - C",1,337,337],
["Apparel - Women's - Plus Sizes - C",1,338,338],
["Arts and Antiques - Antiques - C",1,339,339],
["Arts and Antiques - Art - C",1,340,340],
["Books and Magazines - Magazines - C",1,341,341],
["Books and Music - Books - C",1,342,342],
["Books and Music - Books - Audio - C",1,343,343],
["Children's Apparel - Infants and Toddlers",1,344,344],
["Children's Learning and Activity Toys",1,345,345],
["Children's Products - General - Baby Care - C",1,346,346],
["Children's Products - General - Back-to-School - C",1,347,347],
["Computing/Home Office - General",1,348,348],
["Donation/Contribution - C",1,349,349],
["DVDs/Videos - C",1,350,350],
["Electronics and Computing - TV/Video/Movie Watcher - C",1,351,351],
["Electronics, Computing and Home Office - SC",1,352,352],
["Gardening - C",1,353,353],
["Health and Beauty",1,354,354],
["High End Appliances - C",1,355,355],
["Children's Products - General - SC",1,356,356],
["Home and Garden",1,357,357],
["Hunting",1,358,358],
["Lifestyles, Interests and Passions - Collectibles - C",1,359,359],
["Lifestyles, Interests and Passions - Crafts/Hobbies - C",1,360,360],
["Luggage",1,361,361],
["Magazines",1,362,362],
["Membership Clubs",1,363,363],
["RFM - Method of Payment Total - Cash",3,364,366],
["RFM - Method of Payment Total - Credit Card",3,367,369],
["RFM - Method of Payment Total - Retail Card",3,370,372],
["Military Memorabilia/Weaponry",1,373,373],
["Musical Instruments",1,374,374],
["Off-road Recreational Vehicles",1,375,375],
["Pets - SC",1,376,376],
["Photography and Video Equipment - C",1,377,377],
["Sports and Leisure - SC",1,378,378],
["Telecommunications - SC",1,379,379],
["Travel - C",1,380,380],
["Value-Priced General Merchandise - SC",1,381,381],
["Mail Order Donor",1,382,382],
["Mail Order Buyer",1,383,383],
["Mail Order Responder",1,384,384],
["Credit Card Indicator",6,385,390],
["Bank Card Holder",1,385,385],
["Gas/Department/Retail Card Holder",1,386,386],
["Travel and Entertainment Card Holder",1,387,387],
["Credit Card Holder - Unknown Type",1,388,388],
["Premium Card Holder",1,389,389],
["Upscale (Department Store) Card Holder",1,390,390],
["Online Purchasing Indicator",1,391,391],
["Credit Card User",1,392,392],
["Credit Card - New Issue",1,393,393],
["Bank Card - Presence in Household",1,394,394],
["Number of Lines of Credit (Trade Counter)",1,395,395],
["Credit - Range of New Credit",1,396,396],
["Retail Activity Date of Last",8,397,404],
["Retail Purchases - Categories",21,405,425],
["Standard Retail, Membership Warehouse",1,405,405],
["Standard Retail, Catalog Showroom / Retail Buyers",1,406,406],
["Standard Retail, Main Street Retail",1,407,407],
["Standard Retail, High Volume Low End Department Store Buyers",1,408,408],
["Standard Retail, Standard Retail",1,409,409],
["Standard Specialty, Sporting Goods",1,410,410],
["Standard Specialty, Specialty Apparel",1,411,411],
["Standard Specialty, Specialty",1,412,412],
["Standard Specialty, Computer / Electronics Buyers",1,413,413],
["Standard Specialty, Furniture Buyers",1,414,414],
["Standard Specialty, Home Office Supply Purchases",1,415,415],
["Standard Specialty, Home Improvement",1,416,416],
["Upscale Retail - High End Retail Buyers, Upscale Retail",1,417,417],
["Upscale Specialty, Travel / Personal Services",1,418,418],
["Bank, Financial Services - Banking",1,419,419],
["Finance Company, Financial Services - Install Credit",1,420,420],
["Oil Company, Oil Company",1,421,421],
["Miscellaneous, Financial Services - Insurance",1,422,422],
["Miscellaneous, TV / Mail Order Purchases",1,423,423],
["Miscellaneous, Grocery",1,424,424],
["Miscellaneous, Miscellaneous",1,425,425],
["African American Professionals",1,426,426],
["Highly Likely Investors",1,427,427],
["Likely Investors",1,428,428],
["Income - Estimated Household",1,429,429],
["Income - Estimated Household - Narrow Ranges",1,430,430],
["Health - Allergy Related Interest in HH",1,431,431],
["Health - Arthritis / Mobility Interest in HH",1,432,432],
["Health - Diabetic Interest in HH",1,433,433],
["Health - Disabled Interest in HH",1,434,434],
["Health - Orthopedic Interest in HH",1,435,435],
["Health - Senior Needs Interest in HH",1,436,436],
["Veteran",1,437,437],
["Number of Children - 100%",2,438,439],
["Children",1,438,438],
["Precision Level",1,439,439],
["Home Length of Residence - 100%",3,440,442],
["LOR",2,440,441],
["Precision Level",1,442,442],
["Presence of Children - 100%",2,443,444],
["Children",1,443,443],
["Precision Level",1,444,444],
["SOHO Indicator",1,445,445],
["Political Party - 1st Individual",1,446,446],
["Children's Age Ranges - New",15,447,461],
["Age 00 - 02 Male",1,447,447],
["Age 00 - 02 Female",1,448,448],
["Age 00 - 02 Unknown Gender",1,449,449],
["Age 03 - 05 Male",1,450,450],
["Age 03 - 05 Female",1,451,451],
["Age 03 - 05 Unknown Gender",1,452,452],
["Age 06 - 10 Male",1,453,453],
["Age 06 - 10 Female",1,454,454],
["Age 06 - 10 Unknown Gender",1,455,455],
["Age 11 - 15 Male",1,456,456],
["Age 11 - 15 Female",1,457,457],
["Age 11 - 15 Unknown Gender",1,458,458],
["Age 16 - 17 Male",1,459,459],
["Age 16 - 17 Female",1,460,460],
["Age 16 - 17 Unknown Gender",1,461,461],
["Number of Children - New",1,462,462],
["Children's Age - 1 Year Increments - New",19,463,481],
["Age < 1",1,463,463],
["Age = 1",1,464,464],
["Age = 2",1,465,465],
["Age = 3",1,466,466],
["Age = 4",1,467,467],
["Age = 5",1,468,468],
["Age = 6",1,469,469],
["Age = 7",1,470,470],
["Age = 8",1,471,471],
["Age = 9",1,472,472],
["Age = 10",1,473,473],
["Age = 11",1,474,474],
["Age = 12",1,475,475],
["Age = 13",1,476,476],
["Age = 14",1,477,477],
["Age = 15",1,478,478],
["Age = 16",1,479,479],
["Age = 17",1,480,480],
["Age = 18",1,481,481],
["Occupation - 1st Individual",1,482,482],
["Marital Status in the Household",1,483,483],
["Base Record Verification Date",5,484,488],
["Working Woman",1,489,489],
["Presence of Children - New",1,490,490],
["Number of Adults",1,491,491],
["Household Size",1,492,492],
["Generations in Household",1,493,493],
["Young Adult in Household",1,494,494],
["Senior Adult in Household",1,495,495],
["Education - 1st Individual",1,496,496],
["eMail Append Available Indicator",1,497,497],
["Single Parent",1,498,498],
["Occupation - Input Individual",1,499,499],
["Education - Input Individual",1,500,500],
["Political Party - Input Individual",1,501,501],
["Fashion",1,502,502],
["History / Military",1,503,503],
["Smoking / Tobacco",1,504,504],
["Current Affairs / Politics",1,505,505],
["Theater / Performing Arts",1,506,506],
["Community / Charities",1,507,507],
["Religious / Inspirational",1,508,508],
["Science / Space",1,509,509],
["Career Improvement",1,510,510],
["Food - Wines",1,511,511],
["Arts",1,512,512],
["Reading - General",1,513,513],
["Reading - Religious / Inspirational",1,514,514],
["Reading - Science Fiction",1,515,515],
["Reading - Magazines",1,516,516],
["Reading - Audio Books",1,517,517],
["Cooking - General",1,518,518],
["Cooking - Gourmet",1,519,519],
["Foods - Natural",1,520,520],
["Travel - Domestic",1,521,521],
["Travel - International",1,522,522],
["RV",1,523,523],
["Travel - Cruise Vacations",1,524,524],
["Exercise - Running / Jogging",1,525,525],
["Exercise - Walking",1,526,526],
["Exercise - Aerobic",1,527,527],
["Crafts",1,528,528],
["Photography",1,529,529],
["Aviation",1,530,530],
["Auto Work",1,531,531],
["Sewing / Knitting / Needlework",1,532,532],
["Woodworking",1,533,533],
["Games - Board Games / Puzzles",1,534,534],
["Music - Home Stereo",1,535,535],
["Music Player",1,536,536],
["Music Collector",1,537,537],
["Music - Avid Listener",1,538,538],
["Movie Collector",1,539,539],
["TV - Cable",1,540,540],
["Games - Video Games",1,541,541],
["TV - Satellite Dish",1,542,542],
["Health/Medical",1,543,543],
["Dieting / Weight Loss",1,544,544],
["Self Improvement",1,545,545],
["Cat Owner",1,546,546],
["Dog Owner",1,547,547],
["Other Pet Owner",1,548,548],
["House Plants",1,549,549],
["Parenting",1,550,550],
["Children's Interests",1,551,551],
["Grandchildren",1,552,552],
["Spectator Sports - Auto / Motorcycle Racing",1,553,553],
["Spectator Sports - Football",1,554,554],
["Spectator Sports - Baseball",1,555,555],
["Spectator Sports - Basketball",1,556,556],
["Spectator Sports - Hockey",1,557,557],
["Spectator Sports - Soccer",1,558,558],
["Spectator Sports - Tennis",1,559,559],
["Collectibles - General",1,560,560],
["Collectibles - Stamps",1,561,561],
["Collectibles - Coins",1,562,562],
["Collectibles - Arts",1,563,563],
["Collectibles - Antiques",1,564,564],
["Investments - Personal",1,565,565],
["Investments - Real Estate",1,566,566],
["Investments - Stocks / Bonds",1,567,567],
["Computers",1,568,568],
["Games - Computer Games",1,569,569],
["Consumer Electronics",1,570,570],
["Fishing",1,571,571],
["Camping / Hiking",1,572,572],
["Hunting / Shooting",1,573,573],
["Boating / Sailing",1,574,574],
["Scuba Diving",1,575,575],
["Biking / Mountain Biking",1,576,576],
["Environmental Issues",1,577,577],
["Tennis",1,578,578],
["Golf",1,579,579],
["Snow Skiing",1,580,580],
["Motorcycling",1,581,581],
["Equestrian",1,582,582],
["Home Furnishings / Decorating",1,583,583],
["Home Improvement",1,584,584],
["Gardening",1,585,585],
["Gaming - Casino",1,586,586],
["Sweepstakes / Contests",1,587,587],
["Sports Grouping",1,588,588],
["Outdoors Grouping",1,589,589],
["Travel Grouping",1,590,590],
["Reading Grouping",1,591,591],
["Cooking / Food Grouping",1,592,592],
["Exercise / Health Grouping",1,593,593],
["Movie / Music Grouping",1,594,594],
["Electronics / Computers Grouping",1,595,595],
["Home Improvement Grouping",1,596,596],
["Investing / Finance Grouping",1,597,597],
["Collectibles and Antiques Grouping",1,598,598],
["Boat Owner",1,599,599],
["Career",1,600,600],
["Christian Families",1,601,601],
["Collectibles - Sports Memorabilia",1,602,602],
["Education Online",1,603,603],
["Investments - Foreign",1,604,604],
["NASCAR",1,605,605],
["Reading - Financial Newsletter Subscribers",1,606,606],
["Beauty/Cosmetics",1,607,607],
["Home Improvement - Do-It-Yourselfers",1,608,608],
["Money Seekers",1,609,609],
["Spectator Sports - TV Sports",1,610,610],
["Collector - Avid",1,611,611],
["Home Living",1,612,612],
["DIY Living",1,613,613],
["Sporty Living",1,614,614],
["Upscale Living",1,615,615],
["Cultural/Artistic Living",1,616,616],
["Highbrow",1,617,617],
["High-Tech Living",1,618,618],
["Common Living",1,619,619],
["Professional Living",1,620,620],
["Broader Living",1,621,621],
["Recent Home Buyer",1,622,622],
["Recent Mortgage Borrower",1,623,623],
["New Parent",1,624,624],
["Child Near High School Graduation in HH",1,625,625],
["College Graduate",1,626,626],
["Empty Nester",1,627,627],
["Expectant Parent",1,628,628],
["Vehicle - Intend to Purchase",1,629,629],
["Recent Divorce",1,630,630],
["Newlywed",1,631,631],
["Home Loan Date 1 (RP)",6,632,637],
["Year",4,632,635],
["Month",2,636,637],
["Home Loan Amount Total - Estimated -  Ranges (RP)",1,638,638],
["Home Lot Square Footage - Ranges (RP)",1,639,639],
["Home Year Built - Ranges (RP)",1,640,640],
["Home Square Footage - Ranges (RP)",1,641,641],
["Home Market Value Deciles - Estimated (RP)",2,642,643],
["Home Owner Type Detail (RP)",1,644,644],
["Home Assessed Value - Ranges (RP)",1,645,645],
["Home Purchase Amount - Ranges (RP)",1,646,646],
["Home Loan Date - 2 (RP)",6,647,652],
["Year",4,647,650],
["Month",2,651,652],
["Home Loan Date - 3 (RP)",6,653,658],
["Year",4,653,656],
["Month",2,657,658],
["Home Loan Amount 1 - Original Ranges (RP)",1,659,659],
["Home Loan Amount 2 - Original Ranges (RP)",1,660,660],
["Home Loan Amount 3 - Original Ranges (RP)",1,661,661],
["Home Loan Type 1 (RP)",1,662,662],
["Home Loan Type 2 (RP)",1,663,663],
["Home Loan Interest Rate Type 1 (RP)",1,664,664],
["Home Loan Interest Rate Type 2 (RP)",1,665,665],
["Home Loan Interest Rate Type 3 (RP)",1,666,666],
["Home Loan Transaction Type 1 (RP)",1,667,667],
["Home Loan Transaction Type 2 (RP)",1,668,668],
["Home Purchase Date - Year / Month (RP)",6,669,674],
["Home Property Type Detail (RP)",1,675,675],
["Home Loan-to-Value - Estimated - Ranges (RP)",1,676,676],
["Home Equity Available - Estimated - Ranges (RP)",1,677,677],
["Home Equity Lendable - Estimated - Ranges (RP)",1,678,678],
["Investor - Real Estate (RP)",1,679,679],
["Home Square Footage - Actual (RP)",7,680,686],
["Home Owners Insurance Expiration Date (X-Date) (RP)",4,687,690],
["Loan Month",2,687,688],
["Purchase Month",2,689,690],
["Home Pool Present",1,691,691],
["Home Year Built - Actual (RP)",4,692,695],
["Home Owner / Renter",1,696,696],
["Home Length of Residence",2,697,698],
["Dwelling Type",1,699,699],
["Home Market Value - Estimated",1,700,700],
["Home Purchase Date (YYYY/MM)",6,701,706],
["Home Purchase Year (YYYY)",4,707,710],
["Home Equity Available - Estimated - Ranges",1,711,711],
["Home Property Type (RP)",1,712,712],
["Home Lender Standardization Code 1 (RP)",5,713,717],
["Home Lender Standardization Code 2 (RP)",5,718,722],
["Home Lender Standardization Code 3 (RP)",5,723,727],
["Home Lender Type 1 - Original (RP)",1,728,728],
["Home Lender Type 2 - Original (RP)",1,729,729],
["Home Lender Type 3 - Original (RP)",1,730,730],
["Market Value Quality Indicator (RP)",1,731,731],
["Congressional District",2,732,733],
["PC Internet Connection Type",1,734,734],
["Wireless Product Buyer",1,735,735],
["PC Owner",1,736,736],
["PC DSL/High Speed User",1,737,737],
["PC Operating System",1,738,738],
["PC Software Buyer",1,739,739],
["Travel - Airline",1,740,740],
["Vehicle - New Used Indicator - 1st Vehicle",1,741,741],
["Vehicle - New Used Indicator - 2nd Vehicle",1,742,742],
["Vehicle - Truck/Motorcycle/RV Owner",3,743,745],
["Truck Owner",1,743,743],
["Motorcycle Owner",1,744,744],
["RV Owner",1,745,745],
["Vehicle - New Car Buyer",1,746,746],
["Vehicle - Known Owned Number",1,747,747],
["Vehicle - Dominant Lifestyle Indicator",1,748,748],
["Vehicle - Make Code - 1st Vehicle (numerical format)",2,749,750],
["Vehicle - Model Code - 1st Vehicle (numerical format)",2,751,752],
["Vehicle - Year - 1st Vehicle",4,753,756],
["Vehicle - Make Code - 2nd Vehicle (numerical format)",2,757,758],
["Vehicle - Model Code - 2nd Vehicle (numerical format)",2,759,760],
["Vehicle - Year - 2nd Vehicle",4,761,764],
["Gender - Input Individual",1,765,765],
["Discretionary Income Score (SC)",2,766,767],
["Income Range Premium (SC)",1,768,768],
["Home Market Value Model (SC)",1,769,769],
["Income Range Broad (SC)",1,770,770],
["Charitable Giving Score (SC)",2,771,772],
["Vacation Property Ownership Propensity (SC)",2,773,774],
["Life Insurance Purchase Propensity (SC)",2,775,776],
["Vehicle Value  Index (SC) - RETIRING SOON",2,777,778],
["Vehicle Propensity - Compact (SC) - RETIRING SOON",2,779,780],
["Vehicle Propensity - Coupe (SC) - RETIRING SOON",2,781,782],
["Vehicle Propensity - Exotic (SC) - RETIRING SOON",2,783,784],
["Overall Match Indicator",1,807,807],
["Suppression - Mail - DMA",1,808,808]]

headers = []
for col_spec in spec:
	col_spec[0] = col_spec[0].strip()
	headers.append(col_spec[0])

file=open(file_path, "r")
contents=file.read()
data=[]

for line in contents.split("\n"):
	try:
		line_data = {}
		for col_spec in spec:
			line_data[col_spec[0]] = line[col_spec[2]-1:col_spec[3]]
		data.append(line_data)
	except:
		print "error in", line

output = open(dir + "/" + file_name + "_cleaned.txt","w")


output.write(";".join(headers))
output.write("\n")
for d in data:
	for header in headers:
		output.write(d[header])
		output.write(";")
	output.write("\n")

output.flush()
output.close()














